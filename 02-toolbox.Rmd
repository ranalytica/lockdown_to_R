# Data Science Toolbox

The Data Science Toolbox provides a basic foundation in creating a work environment as a data scientist. This environment is based on the R language. It is an environment for statistical computing and graphics and so much more. It is similar to the S language developed at Bell Laboratories by John Chambers and his team [@wiki]. R language is created by Ross Ihaka and Robert Gentleman at the University of Auckland, New Zealand and is developed by the R Development Core Team. Thus, R is named after the first initials of the co-creators Ross & Robert [@wikipedia]. 

## So Much More

R language is use in many industries such as research in academia, pharmaceutical for clinical trials, finance for risk management, social media for natural language processing and sentiment analysis, manufacturing for predicting demand and market trends and many more.

Below is an example of a reproducible expression in building a simple metric stock analysis in R combined with shiny. We will look into NIO and SPY with a starting date of Jun 01, 2020. 

<details><summary>**View Code**</summary>
```{r env}
# We will use all libraries through out this chapter
library(shiny)
library(plotly)
library(tidyquant)
library(ggplot2)
library(dplyr)
library(dygraphs)
library(timetk)
library(glue)
library(tidyr)

# You can change to whatever ticker you want
ticker <- c("NIO", "SPY")
# tidyquant package for tidy format
StockData <- tq_get(ticker, from = "2020-06-01")
# table format
table3.1 <- StockData[1:6,] %>% kable(caption = 'NIO vs. SPY') %>% kable_styling()
```
</details>
```{r}
table3.1
```

See below for time series chart of NIO's daily closing price. 

<details><summary>**View Code**</summary>
```{r TS, message=FALSE, warning=FALSE}
g2<-StockData %>% filter(symbol == "NIO") %>% select(symbol, date, close) %>% 
  spread(key = symbol, value = close) %>% tk_xts() %>% 
  dygraph(height = 250,main = "NIO Price History", ylab = "Price") %>% dyRangeSelector()


```
</details>

```{r message=FALSE, warning=FALSE, fig.cap='NIO Price'}
g2
```


Compare NIO to an Index.

<details><summary>**View Code**</summary>
```{r compare, message=FALSE, warning=FALSE}
g3 <- StockData %>% select(symbol, date, close) %>% 
  spread(key=symbol, value = close) %>% 
  tk_xts() %>% 
  dygraph(height = 250,main = "NIO vs. SPY") %>% 
  dyRebase(value = 1) %>% 
  dyRangeSelector()
```
</details>
```{r vs, fig.cap='NIO vs. SPY', message=FALSE, warning=FALSE}
g3
```

Stock Price distribution 
<details><summary>**View Code**</summary>
```{r distribution, message=FALSE, warning=FALSE}
fd=function(x) {
  n=length(x)
  r=IQR(x)
  2*r/n^(1/3)
}
Stock_Dist <- StockData %>% 
    filter(symbol=="NIO")
  

p2 <- ggplot(Stock_Dist, 
    aes(x=close)) +
  geom_histogram(aes(y=..density..),
     color="black",
     fill="grey") +
  geom_density(alpha=.2, 
               fill="#FF6666") + 
  labs(x="NIO", 
     y="Frequency",
     title = "NIO Price Distribution")
```
</details>

Interactive graph with Plotly. 

```{r interactive,fig.cap='plotly and ggplot2 package'}
ggplotly(p2)
```

Plot using base R graphics hist function.

```{r baseplot,fig.cap='base r visuals'}
hist(Stock_Dist$close, 
     breaks=30,
     main = "NIO Price Distribution", 
     xlab = "Price"
     )
```
Visualization is a powerful tool, that provides a better understanding of our data sets. Visualization amplifies your messaging and simplifies communication to an audience.  Visualization provides an insight to make better decision. We can see from figure \@ref(fig:interactive) and \@ref(fig:baseplot) that the data is bi-modal. There are two groups of buyers here. The first group bought it at around 7 and the other one at 13. There are many factors that we do not see in these two charts such as date and time, current news, trade environment and many more. This are just some of the tools that R can provide.

Lets create another chart comparing the movement of NIO and SPY and see if there is a relationship. Let's also invest 100 dollars and see the difference between the two tickers. The date is set on 01-01-2019.  

<details><summary>**View Code**</summary>
```{r relationship, message=FALSE, warning=FALSE}
# clear everything
rm(list = ls())

ticker <- c("NIO", "SPY")

StockData <- tq_get(ticker, from = "2019-01-01")

# initial investment of 1000
NIO <- StockData %>% 
  filter(symbol =="NIO") %>%  
  select(symbol, date, close) %>% 
  mutate(init=100*close[[1]], 
         actual = close*100, 
         ratio =round(((actual/init)-1)*100, digits=3))

SPY <- StockData %>% 
  filter(symbol =="SPY") %>%  
  select(symbol, date, close) %>% 
  mutate(init=100*close[[1]], 
         actual = close*100, 
         ratio =round(((actual/init)-1)*100, digits=3))

# Data Wrangling
NIO <- NIO %>% 
  filter(symbol == "NIO") %>% 
  select(symbol, date, ratio) %>%  
  rename(NIO = ratio)

SPY <- SPY %>% 
  filter(symbol == "SPY") %>% 
  select(symbol, date, ratio) %>%  
  rename(SPY = ratio)

# Combining data frame
StockData <- left_join(NIO, SPY, by="date") %>% 
  select(date, NIO, SPY)

NIO_h <- StockData %>% filter(NIO > 100)
SPy_h <-StockData %>% filter(SPY> 30)

g4 <- ggplot(StockData, aes(x=NIO, y=SPY),color="grey")+
  geom_point(alpha=.5)+
  geom_smooth(method = "lm")+
  labs(title = "Percentage Gain")+
  geom_point(data = NIO_h, aes(x=NIO, y=SPY), color = "red", alpha = .3)+
  geom_point(data = SPy_h, aes(x=NIO, y=SPY), color = "blue",alpha = .3)
```
</details>
```{r NIOsPy, fig.cap='Beta', warning=FALSE, message=FALSE}
g4
```
We can see from figure \@ref(fig:NIOsPy) that the blue line is almost horizontal with a slightly positive relationship and close to zero - meaning no relationship. The correlation between NIO and SPY is `r cor(StockData$NIO, StockData$SPY)`, which again is close to zero.

Once we combine all of these graphs. We can create a dashboard using Shiny. [Click to see.](https://ranalytica.shinyapps.io/simple_stock_metric/){target="_blank"}

Now, that you've seen the power of R. What do you think? 


## Layout of the Course 

The first 2 weeks course discussions are as follows:

- What is Data Science
- What is Data
- What is Data Scientist
- R installation
- RStudio installation
- R packages

Third and fourth week discussion as follows:

- Git and Github
- Linking Github to RStudio
- Formulating Data Science questions
- Experimental Design
- What is Big Data

## What is Data Science?

Data Science, some call it sexy, others call it 

Create a Venn Diagram

<details><summary>**View Code**</summary>
```{r fig.width=6}
library(tidyverse)
library(ggforce)

## Data frame - All of the arguments below are required to build the venn diagram. 

VennDS <- tibble(
  # Center of each circles
  x = c(0, 1,-1),  
  y = c(-0.5, 1, 1),
  # label coordinates if needed
  tx = NULL,
  ty = NULL,
  cat = c('Variety', 'Velocity',
          'Volume')
)
# ggplot argument x0, y0, r are all required,
vennd <- ggplot(VennDS, aes(
  x0 = x,
  y0 = y,
  r = 1.5,
  fill = cat
)) + geom_circle(
  alpha = 0.25,
  size = 1,
  color = "transparent",
  show.legend = FALSE) + 
  # using geom_text to draw on the graph
  geom_text(aes(x = -1.5 , y = 1, label = "Volume"), size = 5) +       
  geom_text(aes(x = 1.5 , y = 1, label = "Velocity"), size = 5) +
  geom_text(aes(x = 0 , y = -1, label = "Variety"), size = 5) +
  geom_text(aes(x = 0 , y = .75, label = "Big Data"), size = 5)
```
</details>


```{r fig.cap='[@ggforce]'}
vennd 
```

## What is Data?

Need input

## What is a data scientist?

<div align="center">“who combines the skills of software programmer,<br> statistician and storyteller slash artist to extract<br>the nuggets of gold hidden under mountains of data”<br>[@economist]</div>

